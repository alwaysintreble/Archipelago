

<!doctype html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Archipelago Unit Testing API &#8212; Archipelago 0.4.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css?v=94aef301" />
    
    <script src="_static/documentation_options.js?v=340bb9e5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Archipelago Network Protocol" href="network%20protocol.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="network%20protocol.html" title="Archipelago Network Protocol"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Archipelago 0.4.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Archipelago Unit Testing API</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="archipelago-unit-testing-api">
<h1>Archipelago Unit Testing API<a class="headerlink" href="#archipelago-unit-testing-api" title="Link to this heading">¶</a></h1>
<p>This document covers some of the generic tests available using Archipelago’s unit testing system, as well as some basic
steps on how to write your own.</p>
<section id="generic-tests">
<h2>Generic Tests<a class="headerlink" href="#generic-tests" title="Link to this heading">¶</a></h2>
<p>Some generic tests are run on every World to ensure basic functionality with default options. These basic tests can be
found in the <a class="reference internal" href="#/test/general"><span class="xref myst">general test directory</span></a>.</p>
</section>
<section id="defining-world-tests">
<h2>Defining World Tests<a class="headerlink" href="#defining-world-tests" title="Link to this heading">¶</a></h2>
<p>In order to run tests from your world, you will need to create a <code class="docutils literal notranslate"><span class="pre">test</span></code> package within your world package. This can be
done by creating a <code class="docutils literal notranslate"><span class="pre">test</span></code> directory with a file named <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> inside it inside your world. By convention, a base
for your world tests can be created in this file that you can then import into other modules.</p>
<section id="worldtestbase">
<h3>WorldTestBase<a class="headerlink" href="#worldtestbase" title="Link to this heading">¶</a></h3>
<p>In order to test basic functionality of varying options, as well as to test specific edge cases or that certain
interactions in the world interact as expected, you will want to use the <a class="reference internal" href="#/test/bases.py"><span class="xref myst">WorldTestBase</span></a>. This class
comes with the basics for test setup as well as a few preloaded tests that most worlds might want to check on varying
options combinations.</p>
<p>Example <code class="docutils literal notranslate"><span class="pre">/worlds/&lt;my_game&gt;/test/__init__.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">test.bases</span> <span class="kn">import</span> <span class="n">WorldTestBase</span>


<span class="k">class</span> <span class="nc">MyGameTestBase</span><span class="p">(</span><span class="n">WorldTestBase</span><span class="p">):</span>
    <span class="n">game</span> <span class="o">=</span> <span class="s2">&quot;My Game&quot;</span>
</pre></div>
</div>
<p>The basic tests that WorldTestBase comes with include <code class="docutils literal notranslate"><span class="pre">test_all_state_can_reach_everything</span></code>,
<code class="docutils literal notranslate"><span class="pre">test_empty_state_can_reach_something</span></code>, and <code class="docutils literal notranslate"><span class="pre">test_fill</span></code>. These test that with all collected items everything is
reachable, with no collected items at least something is reachable, and that a valid multiworld can be completed with
all steps being called, respectively.</p>
</section>
<section id="writing-tests">
<h3>Writing Tests<a class="headerlink" href="#writing-tests" title="Link to this heading">¶</a></h3>
<section id="using-worldtestbase">
<h4>Using WorldTestBase<a class="headerlink" href="#using-worldtestbase" title="Link to this heading">¶</a></h4>
<p>Adding runs for the basic tests for a different option combination is as easy as making a new module in the test
package, creating a class that inherits from your game’s TestBase, and defining the options in a dict as a field on the
class. The new module should be named <code class="docutils literal notranslate"><span class="pre">test_&lt;something&gt;.py</span></code> and have at least one class inheriting from the base, or
define its own testing methods. Newly defined test methods should follow standard PEP8 snake_case format and also start
with <code class="docutils literal notranslate"><span class="pre">test_</span></code>.</p>
<p>Example <code class="docutils literal notranslate"><span class="pre">/worlds/&lt;my_game&gt;/test/test_chest_access.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">MyGameTestBase</span>


<span class="k">class</span> <span class="nc">TestChestAccess</span><span class="p">(</span><span class="n">MyGameTestBase</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;difficulty&quot;</span><span class="p">:</span> <span class="s2">&quot;easy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;final_boss_hp&quot;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">test_sword_chests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test locations that require a sword&quot;&quot;&quot;</span>
        <span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Chest1&quot;</span><span class="p">,</span> <span class="s2">&quot;Chest2&quot;</span><span class="p">]</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;Sword&quot;</span><span class="p">]]</span>
        <span class="c1"># This tests that the provided locations aren&#39;t accessible without the provided items, but can be accessed once</span>
        <span class="c1"># the items are obtained.</span>
        <span class="c1"># This will also check that any locations not provided don&#39;t have the same dependency requirement.</span>
        <span class="c1"># Optionally, passing only_check_listed=True to the method will only check the locations provided.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAccessDependency</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>When tests are run, this class will create a multiworld with a single player having the provided options, and run the
generic tests, as well as the new custom test. Each test method definition will create its own separate solo multiworld
that will be cleaned up after. If you don’t want to run the generic tests on a base, <code class="docutils literal notranslate"><span class="pre">run_default_tests</span></code> can be
overridden. For more information on what methods are available to your class, check the
<a class="reference internal" href="#/test/bases.py#L104"><span class="xref myst">WorldTestBase definition</span></a>.</p>
</section>
<section id="alternatives-to-worldtestbase">
<h4>Alternatives to WorldTestBase<a class="headerlink" href="#alternatives-to-worldtestbase" title="Link to this heading">¶</a></h4>
<p>Unit tests can also be created using <a class="reference internal" href="#/test/bases.py#L14"><span class="xref myst">TestBase</span></a> or
<a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase">unittest.TestCase</a> depending on your use case. These
may be useful for generating a multiworld under very specific constraints without using the generic world setup, or for
testing portions of your code that can be tested without relying on a multiworld to be created first.</p>
</section>
</section>
</section>
<section id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Link to this heading">¶</a></h2>
<p>In PyCharm, running all tests can be done by right-clicking the root <code class="docutils literal notranslate"><span class="pre">test</span></code> directory and selecting <code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">Python</span> <span class="pre">tests</span></code>.
If you do not have pytest installed, you may get import failures. To solve this, edit the run configuration, and set the
working directory of the run to the Archipelago directory. If you only want to run your world’s defined tests, repeat
the steps for the test directory within your world.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/header-logo.svg" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Archipelago Unit Testing API</a><ul>
<li><a class="reference internal" href="#generic-tests">Generic Tests</a></li>
<li><a class="reference internal" href="#defining-world-tests">Defining World Tests</a><ul>
<li><a class="reference internal" href="#worldtestbase">WorldTestBase</a></li>
<li><a class="reference internal" href="#writing-tests">Writing Tests</a><ul>
<li><a class="reference internal" href="#using-worldtestbase">Using WorldTestBase</a></li>
<li><a class="reference internal" href="#alternatives-to-worldtestbase">Alternatives to WorldTestBase</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#running-tests">Running Tests</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="network%20protocol.html"
                          title="previous chapter">Archipelago Network Protocol</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tests.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="network%20protocol.html" title="Archipelago Network Protocol"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Archipelago 0.4.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Archipelago Unit Testing API</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Archipelago.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>